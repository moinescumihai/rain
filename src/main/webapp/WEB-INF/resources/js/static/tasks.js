var statusHtml = '<div class="col-md-$columnSize$">' +    '<section class="panel panel-default tasks-widget">' +    '<div class="panel-heading"><h3 class="panel-title">$statusTitle$</h3></div>' +    '<div id="$idStatusTask$-container" class="task-list task-container panel-body" style="min-height: $windowHeight$px">' +    '</div></section></div>';var taskHtml = '<div id="$idTask$-task" data-ordine="$ordine$" data-container="$container$" class="$taskType$ todo-task">' +    '<i class="fa fa-ellipsis-v"></i><div class="task-checkbox">' +    '<div class="task-title"><span class="task-title-sp">$numeTask$</span>' +    '<span class="badge badge-sm label-success">$timpRamas$</span>' +    '<div class="pull-right hidden-phone">' +    '<button class="btn btn-primary btn-xs fa fa-pencil"></button>' +    '</div></div></div>';var taskContainer = $(".task-container");var tasktype = ['list-primary', 'list-success', 'list-warning', 'list-info', 'list-inverse'];var getTaskStatus = function () {    var statusList = [];    $.ajax({        type: 'get',        url: '/app/secure/tasks/get-all-status',        contentType: "application/json",        async: false,        success: function (taskStatusList) {            statusList = taskStatusList;        },        error: function () {            showNotification("Eroare. Re&icirc;nc&abreve;rca&#539;i pagina.", "Eroare", ERROR);        }    });    return statusList;};var getTaskById = function (id) {    var retTask = {};    $.ajax({        type: 'get',        url: '/app/secure/tasks/get-task/' + id,        contentType: "application/json",        async: false,        success: function (task) {            retTask = task;        },        error: function () {            showNotification("Eroare. Re&icirc;nc&abreve;rca&#539;i pagina.", "Eroare", ERROR);        }    });    return retTask;};var removeElement = function (id) {    $("#" + id).remove();};var generateTask = function (task) {    var randomTaskType = tasktype[Math.floor(Math.random() * tasktype.length)];    var statusContainer = '#' + task.idStatusTask.idStatusTask + '-container';    var idTask = task.idTask;    var numeTask = task.nume;    var ordine = task.ordine;    var timpRamas = task.estimare;    $(statusContainer).append(chain(taskHtml)        .replace(/\$idTask\$/, idTask)        .replace(/\$taskType\$/, randomTaskType)        .replace(/\$numeTask\$/, numeTask)        .replace(/\$timpRamas\$/, timpRamas)        .replace(/\$ordine\$/, ordine)        .replace(/\$container\$/, statusContainer));    $(statusContainer).disableSelection();};var updateTask = function (task) {    var token = $("meta[name='_csrf']").prop("content");    var header = $("meta[name='_csrf_header']").prop("content");    $.ajax({        type: 'post',        url: '/app/secure/tasks/update-task',        beforeSend: function (xhr) {            xhr.setRequestHeader(header, token);        },        dataType: 'json',        contentType: 'application/json',        mimeType: 'application/json',        data: JSON.stringify(task),        success: function (response) {            showNotification(response.message, 'Success', SUCCESS);        },        error: function () {            showNotification("Eroare. Re&icirc;nc&abreve;rca&#539;i pagina.", "Eroare", ERROR);        }    });};var getTasks = function () {    var taskStatusList = getTaskStatus();    var statusColumWidth = 12 / taskStatusList.length;    $.ajax({        type: 'get',        url: '/app/secure/tasks/get-current',        contentType: "application/json",        success: function (tasks) {            var idStatusTask,                statusContainer,                windowHeight = $(document).height() - 150;            $.each(taskStatusList, function (index, status) {                idStatusTask = status.idStatusTask;                statusContainer = '#' + idStatusTask + '-container';                taskContainer.append(chain(statusHtml)                    .replace(/\$columnSize\$/, statusColumWidth)                    .replace(/\$idStatusTask\$/, idStatusTask)                    .replace(/\$statusTitle\$/, status.nume)                    .replace(/\$windowHeight\$/, windowHeight));                $(statusContainer).sortable({                    update: function (event, ui) {                        console.log(ui);                    }                });                $(statusContainer).droppable({                    hoverClass: "drop-hover",                    accept: ".todo-task",                    greedy: true,                    drop: function (event, ui) {                        var element = ui.helper,                            css_id = element.prop("id"),                            destinationContainer = $(event.target),                            task = getTaskById(parseInt(css_id)),                            destinationContainerId = parseInt(destinationContainer.prop('id'));                        if (destinationContainerId !== task.idStatusTask.idStatusTask) {                            removeElement(css_id);                            task.idStatusTask.idStatusTask = destinationContainerId;                            generateTask(task);                            updateTask(task);                        }                    }                });            });            $.each(tasks, function (index, task) {                generateTask(task);            });        },        error: function (e) {            showNotification("Eroare. Re&icirc;nc&abreve;rca&#539;i pagina." + e.message, "Eroare", ERROR);        }    });};$(document).ready(function () {    $('#tasks').addClass('active');    TaskList.initTaskWidget();    getTasks();    $(".todo-task").draggable({revert: "valid", revertDuration: 200});});